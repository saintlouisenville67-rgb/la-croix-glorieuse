<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mon Rosaire Quotidien</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --rosaire-blue: #1e40af; /* Bleu profond */
            --rosaire-blue-light: #3b82f6; /* Bleu plus clair pour le contraste */
            --bg-light: #f8fafc; /* Gris tr√®s clair */
            --card-light: #ffffff; /* Blanc carte */
            --text-color-light: #1f2937; /* Gris fonc√© */
            --text-color-light-soft: #64748b; /* Gris doux */
        }
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-light: #0f172a; /* Bleu marine tr√®s fonc√© */
                --card-light: #1e293b; /* Bleu marine fonc√© */
                --text-color-light: #f1f5f9; /* Blanc cass√© */
                --text-color-light-soft: #94a3b8; /* Gris bleut√© */
            }
            body { color: var(--text-color-light); }
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-light);
            margin: 0; padding: 20px; text-align: center;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh;
        }
        .container {
            max-width: 500px;
            width: 100%;
            margin: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .card {
            background: var(--card-light);
            border-radius: 32px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            min-height: 200px; /* Ajust√© pour l'accueil */
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .prayer-card {
            min-height: 580px; /* Plus grand pour le mode pri√®re */
        }
        .mystery-badge {
            background: #eff6ff; /* Couleurs Tailwind par d√©faut pour badge */
            color: var(--rosaire-blue);
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
            margin-bottom: 10px;
        }
        @media (prefers-color-scheme: dark) {
            .mystery-badge { background: #1e3a8a; color: #dbeafe; }
        }
        .fruit-box {
            font-size: 0.8rem;
            color: var(--text-color-light-soft);
            font-style: italic;
            margin-top: 5px;
            display: block;
        }
        .bead-btn {
            width: 70px; height: 70px; border-radius: 50%;
            background: var(--rosaire-blue); /* Couleur primaire pour le bouton */
            color: white;
            border: none; /* Supprimer la bordure */
            display: flex; align-items: center; justify-content: center;
            margin: 15px auto; cursor: pointer; transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            position: relative;
        }
        .bead-btn:active { transform: scale(0.95); }

        /* Animation Glow */
        @keyframes pulse-blue {
            0% { box-shadow: 0 0 0 0 rgba(30, 64, 175, 0.4); }
            70% { box-shadow: 0 0 0 20px rgba(30, 64, 175, 0); }
            100% { box-shadow: 0 0 0 0 rgba(30, 64, 175, 0); }
        }
        .bead-btn.glowing {
            animation: pulse-blue 2s infinite;
        }
        @media (prefers-color-scheme: dark) {
             @keyframes pulse-blue {
                0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.3); }
                70% { box-shadow: 0 0 0 20px rgba(59, 130, 246, 0); }
                100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
            }
            .bead-btn.glowing {
                animation: pulse-blue 2s infinite;
            }
        }


        .progress-dot { width: 6px; height: 6px; border-radius: 50%; background: #e2e8f0; transition: all 0.3s; }
        .progress-dot.active { background: var(--rosaire-blue); transform: scale(1.4); }

        /* Nouvelle barre de progression globale */
        .global-progress-bar {
            width: 100%;
            height: 8px;
            background-color: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        .global-progress-fill {
            height: 100%;
            width: 0%;
            background-color: var(--rosaire-blue-light);
            border-radius: 4px;
            transition: width 0.3s ease-out;
        }
         @media (prefers-color-scheme: dark) {
            .global-progress-bar { background-color: #334155; }
            .global-progress-fill { background-color: var(--rosaire-blue-light); }
        }

        .text-fade { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Styles pour l'accueil */
        .home-screen {
            display: flex;
            flex-direction: column;
            gap: 15px;
            justify-content: center;
            align-items: center;
            padding: 30px;
        }
        .home-screen button {
            background-color: var(--rosaire-blue);
            color: white;
            padding: 15px 30px;
            border-radius: 16px;
            font-size: 1.1rem;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 300px;
        }
        .home-screen button:hover {
            background-color: var(--rosaire-blue-light);
            transform: translateY(-2px);
        }
        .home-screen button:active {
            transform: translateY(0);
        }

        /* Styles pour la vue d'ensemble */
        .overview-screen {
            padding: 20px;
            text-align: left;
        }
        .overview-screen h3 {
            font-size: 1.25rem;
            font-weight: bold;
            color: var(--rosaire-blue);
            margin-bottom: 20px;
            text-align: center;
        }
        .mystery-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
            gap: 15px;
            padding: 15px;
            background-color: var(--bg-light);
            border-radius: 16px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            transition: transform 0.2s ease-in-out;
        }
        .mystery-item:last-child {
            margin-bottom: 0;
        }
        .mystery-item-icon {
            font-size: 1.8rem;
            line-height: 1;
            flex-shrink: 0;
            color: var(--rosaire-blue-light);
        }
        .mystery-item-content {
            flex-grow: 1;
        }
        .mystery-item h4 {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: var(--text-color-light);
        }
        .mystery-item p {
            font-size: 0.9rem;
            color: var(--text-color-light-soft);
            line-height: 1.4;
        }

    </style>
</head>
<body>

    <div class="container">

        <div id="home-screen" class="card home-screen">
            <h1 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-6">Prier le Rosaire</h1>
            <div id="mystery-type-home" class="mystery-badge mb-8">Chargement...</div>
            <button onclick="startRosary()">Commencer le Rosaire</button>
            <button onclick="showOverview()" class="bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-100 mt-3">Voir les myst√®res du jour</button>
        </div>

        <div id="rosary-screen" class="card prayer-card mt-8 hidden">
            <div>
                <div id="mystery-type" class="mystery-badge">Chargement...</div>

                <div class="global-progress-bar">
                    <div id="global-progress-fill" class="global-progress-fill"></div>
                </div>

                <h2 id="step-title" class="text-[10px] font-900 uppercase tracking-[0.3em] text-blue-800 dark:text-blue-400">D√©but</h2>

                <div class="my-6 min-h-[220px] flex flex-col items-center justify-center px-2">
                    <p id="prayer-content" class="text-base italic font-serif leading-relaxed text-slate-700 dark:text-slate-200 text-fade">
                        Au nom du P√®re...
                    </p>
                    <span id="mystery-fruit" class="fruit-box hidden"></span>
                </div>
            </div>

            <div>
                <div id="progress-container" class="flex justify-center gap-1.5 mb-4 hidden"></div>
                <p id="counter-text" class="text-[9px] font-black text-slate-400 dark:text-slate-500 uppercase tracking-widest mb-2"></p>

                <button id="next-btn" onclick="nextStep()" class="bead-btn glowing">
                    <span id="bead-icon" class="text-2xl">üìø</span>
                </button>

                <p id="instruction" class="text-[9px] font-bold text-slate-300 uppercase mt-4">Touchez le grain pour avancer</p>
            </div>
        </div>

        <div id="overview-screen" class="card overview-screen hidden">
            <h3>Les Myst√®res <span id="overview-mystery-type" class="font-normal text-blue-600 dark:text-blue-300"></span> du jour</h3>
            <div id="mysteries-list">
                </div>
            <button onclick="backToHome()" class="bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-100 mt-6 w-full max-w-none">Retour √† l'accueil</button>
        </div>

    </div>

    <script>
        // --- TEXTES DES PRI√àRES ---
        const PRAYERS = {
            credo: "Je crois en Dieu, le P√®re tout-puissant, Cr√©ateur du ciel et de la terre. Et en J√©sus-Christ, son Fils unique, notre Seigneur ; qui a √©t√© con√ßu du Saint-Esprit, est n√© de la Vierge Marie, a souffert sous Ponce Pilate, a √©t√© crucifi√©, est mort et a √©t√© enseveli, est descendu aux enfers ; le troisi√®me jour est ressuscit√© des morts, est mont√© aux cieux, est assis √† la droite de Dieu le P√®re tout-puissant, d‚Äôo√π il viendra juger les vivants et les morts. Je crois en l'Esprit-Saint, √† la sainte Eglise catholique, √† la communion des saints, √† la r√©surrection de la chair, √† la vie √©ternelle. Amen.",
            pater: "Notre P√®re, qui √™tes aux cieux, que votre nom soit sanctifi√©, que votre r√®gne vienne, que votre volont√© soit faite sur la terre comme au ciel. Donnez-nous aujourd‚Äôhui notre pain de ce jour. Pardonnez-nous nos offenses, comme nous pardonnons aussi √† ceux qui nous ont offens√©s. Et ne nous laissez pas succomber √† la tentation, mais d√©livrez-nous du mal. Amen.",
            ave: "Je vous salue, Marie, pleine de gr√¢ce ; le Seigneur est avec vous. Vous √™tes b√©nie entre toutes les femmes et J√©sus, le fruit de vos entrailles, est b√©ni. Sainte Marie, M√®re de Dieu, priez pour nous pauvres p√©cheurs, maintenant et √† l‚Äôheure de notre mort. Amen.",
            gloria: "Gloire au P√®re, et au Fils, et au Saint-Esprit. Comme il √©tait au commencement, maintenant et toujours, et dans les si√®cles des si√®cles. Amen.",
            fatima: "√î mon J√©sus, pardonnez-nous nos p√©ch√©s, pr√©servez-nous du feu de l'enfer, et conduisez au Ciel toutes les √¢mes, surtout celles qui ont le plus besoin de Votre Mis√©ricorde."
        };

        // --- MYST√àRES ---
        const MYSTERIES = {
            joyeux: [
                { t: "L'Annonciation", f: "L'humilit√©", icon: "üïäÔ∏è" },
                { t: "La Visitation", f: "La charit√© fraternelle", icon: "ü§ù" },
                { t: "La Nativit√©", f: "L'esprit de pauvret√©", icon: "üåü" },
                { t: "La Pr√©sentation", f: "L'ob√©issance et la puret√©", icon: "üïØÔ∏è" },
                { t: "Le Recouvrement", f: "La recherche de Dieu", icon: "üîé" }
            ],
            lumineux: [
                { t: "Le Bapt√™me de J√©sus", f: "L'√©tat de gr√¢ce", icon: "üíß" },
                { t: "Les Noces de Cana", f: "La confiance en Marie", icon: "ü•Ç" },
                { t: "L'Annonce du Royaume", f: "La conversion", icon: "üì¢" },
                { t: "La Transfiguration", f: "La pri√®re", icon: "‚ú®" },
                { t: "L'Institution de l'Eucharistie", f: "La ferveur", icon: "üçû" }
            ],
            douloureux: [
                { t: "L'Agonie", f: "La contrition", icon: "ü©∏" },
                { t: "La Flagellation", f: "La mortification des sens", icon: "‚õìÔ∏è" },
                { t: "Le Couronnement d'√©pines", f: "La mortification de l'esprit", icon: "üëë" },
                { t: "Le Portement de Croix", f: "La patience", icon: "üéöÔ∏è" },
                { t: "La Crucifixion", f: "L'amour de Dieu et des √¢mes", icon: "‚úùÔ∏è" }
            ],
            glorieux: [
                { t: "La R√©surrection", f: "La foi", icon: "‚òÄÔ∏è" },
                { t: "L'Ascension", f: "L'esp√©rance", icon: "‚òÅÔ∏è" },
                { t: "La Pentec√¥te", f: "Le z√®le", icon: "üî•" },
                { t: "L'Assomption", f: "La d√©votion √† Marie", icon: "üíñ" },
                { t: "Le Couronnement de Marie", f: "La pers√©v√©rance finale", icon: "üëë" }
            ]
        };

        // --- LOGIQUE DE D√âTECTION DES MYST√àRES DU JOUR ---
        let day = new Date().getDay(); // 0=Dim, 1=Lun...
        let currentMysteries = [];
        let typeLabel = "";

        // D√©termination des myst√®res en fonction du jour
        if (day === 1 || day === 6) { currentMysteries = MYSTERIES.joyeux; typeLabel = "Joyeux"; }
        else if (day === 2 || day === 5) { currentMysteries = MYSTERIES.douloureux; typeLabel = "Douloureux"; }
        else if (day === 4) { currentMysteries = MYSTERIES.lumineux; typeLabel = "Lumineux"; }
        else { currentMysteries = MYSTERIES.glorieux; typeLabel = "Glorieux"; }

        // Mettre √† jour les badges sur l'√©cran d'accueil et de pri√®re
        document.getElementById('mystery-type-home').innerText = `Myst√®res ${typeLabel}`;
        document.getElementById('mystery-type').innerText = `Myst√®res ${typeLabel}`; // Pour l'√©cran de pri√®re
        document.getElementById('overview-mystery-type').innerText = typeLabel; // Pour l'√©cran d'aper√ßu

        // --- √âTATS GLOBAUX DU ROSAIRE ---
        let step = 0; // 0:Signe, 1:Credo, 2:Pater, 3:3xAve, 4:Gloria (ouverture)
        let decade = 0; // 0 √† 4 (pour les 5 dizaines)
        let bead = -1; // -1:Pater de la dizaine, 0-9: Ave, 10:Gloria/Fatima
        let isStarted = false; // Vrai une fois les pri√®res d'ouverture pass√©es

        // --- GESTION DES √âCRANS ---
        const homeScreen = document.getElementById('home-screen');
        const rosaryScreen = document.getElementById('rosary-screen');
        const overviewScreen = document.getElementById('overview-screen');

        function showScreen(screenId) {
            homeScreen.classList.add('hidden');
            rosaryScreen.classList.add('hidden');
            overviewScreen.classList.add('hidden');
            document.getElementById(screenId).classList.remove('hidden');
        }

        function startRosary() {
            showScreen('rosary-screen');
            updateUI();
        }

        function showOverview() {
            renderOverview(); // G√©n√®re la liste des myst√®res
            showScreen('overview-screen');
        }

        function backToHome() {
            showScreen('home-screen');
        }

        // --- RENDU DE LA VUE D'ENSEMBLE ---
        function renderOverview() {
            const listContainer = document.getElementById('mysteries-list');
            listContainer.innerHTML = ""; // Nettoyer avant d'ajouter

            currentMysteries.forEach((mystery, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'mystery-item';
                itemDiv.innerHTML = `
                    <span class="mystery-item-icon">${mystery.icon || 'üìñ'}</span>
                    <div class="mystery-item-content">
                        <h4>${index + 1}. ${mystery.t}</h4>
                        <p>Fruit : ${mystery.f}</p>
                    </div>
                `;
                listContainer.appendChild(itemDiv);
            });
        }

        // --- MISE √Ä JOUR DE L'INTERFACE DE PRI√àRE ---
        function updateUI() {
            const content = document.getElementById('prayer-content');
            const fruit = document.getElementById('mystery-fruit');
            const title = document.getElementById('step-title');
            const progress = document.getElementById('progress-container');
            const counter = document.getElementById('counter-text');
            const icon = document.getElementById('bead-icon');
            const globalProgressFill = document.getElementById('global-progress-fill');
            const nextBtn = document.getElementById('next-btn');

            fruit.classList.add('hidden');
            progress.classList.add('hidden');
            counter.innerText = "";
            nextBtn.classList.add('glowing'); // Le bouton brille par d√©faut

            content.classList.remove('text-fade'); // Reset animation
            void content.offsetWidth; // Trigger reflow
            content.classList.add('text-fade'); // Re-apply animation

            // --- Logique de progression globale (pour la barre) ---
            let globalProgress = 0;
            if (!isStarted) {
                globalProgress = (step / 5) * 10; // L'ouverture repr√©sente ~10% de la pri√®re totale
            } else {
                // Chaque dizaine repr√©sente 1/5√®me du rosaire principal
                // On ajoute la progression de la dizaine en cours (bead)
                globalProgress = 10 + (decade * 18) + (bead === -1 ? 0 : (bead === 10 ? 1.5 : (bead + 1) / 10 * 16.5));
                // 10% pour l'ouverture, puis 5 dizaines de 18% chacune (10+5*18 = 100)
                // Le Pater (-1) est 0, les Ave (0-9) sont 16.5% de la dizaine, Gloria (10) est 1.5% restant
                if (globalProgress > 100) globalProgress = 100; // S'assurer de ne pas d√©passer
            }
            globalProgressFill.style.width = `${globalProgress}%`;


            if (!isStarted) {
                title.innerText = "Ouverture";
                if(step === 0) content.innerText = "Au nom du P√®re, et du Fils, et du Saint-Esprit. Amen.";
                if(step === 1) content.innerText = PRAYERS.credo;
                if(step === 2) content.innerText = PRAYERS.pater;
                if(step === 3) content.innerText = PRAYERS.ave + " (3 fois pour la Foi, l'Esp√©rance et la Charit√©)";
                if(step === 4) content.innerText = PRAYERS.gloria;
                icon.innerText = "üìø";
            } else {
                let m = currentMysteries[decade];
                title.innerText = m.t;
                fruit.innerText = "Fruit : " + m.f;
                fruit.classList.remove('hidden');

                if (bead === -1) {
                    content.innerText = PRAYERS.pater;
                    icon.innerText = "‚ö™"; // Grosse perle
                } else if (bead >= 0 && bead <= 9) {
                    content.innerText = PRAYERS.ave;
                    progress.classList.remove('hidden');
                    counter.innerText = `Dizaine ${decade+1} ‚Ä¢ Grain ${bead+1}/10`;
                    icon.innerText = "üîπ"; // Petite perle
                    renderDots();
                } else { // bead === 10 (Gloria + Fatima)
                    content.innerText = PRAYERS.gloria + "\n\n---\n\n" + PRAYERS.fatima;
                    icon.innerText = "‚ú®"; // √âtoile
                }
            }
        }

        function renderDots() {
            const container = document.getElementById('progress-container');
            container.innerHTML = "";
            for (let i = 0; i < 10; i++) {
                const dot = document.createElement('div');
                dot.className = `progress-dot ${i <= bead ? 'active' : ''}`;
                container.appendChild(dot);
            }
        }

        function nextStep() {
            const nextBtn = document.getElementById('next-btn');
            nextBtn.classList.remove('glowing'); // Arr√™ter l'animation au clic
            void nextBtn.offsetWidth; // Trigger reflow
            // L'animation sera relanc√©e par updateUI √† la prochaine √©tape si besoin

            if (!isStarted) {
                if (step < 4) {
                    step++;
                } else {
                    isStarted = true;
                    step = 0; // R√©initialiser le step pour ne plus l'utiliser
                }
            } else {
                if (bead < 10) {
                    bead++;
                } else {
                    if (decade < 4) {
                        decade++;
                        bead = -1; // Revenir au Pater pour la nouvelle dizaine
                    } else {
                        // FIN DU ROSAIRE
                        document.getElementById('prayer-content').innerText = "Salve Regina...\n\n---\n\nAu nom du P√®re, et du Fils, et du Saint-Esprit. Amen.\n\nF√©licitations, le Rosaire est termin√© !";
                        document.getElementById('instruction').innerText = "Redirection vers l'accueil...";
                        document.getElementById('next-btn').classList.add('hidden'); // Cacher le bouton
                        document.getElementById('progress-container').classList.add('hidden');
                        document.getElementById('counter-text').classList.add('hidden');
                        document.getElementById('step-title').innerText = "Fin du Rosaire";
                        document.getElementById('mystery-fruit').classList.add('hidden');
                        document.getElementById('global-progress-fill').style.width = `100%`; // Assurer 100%
                        setTimeout(() => backToHome(), 5000); // Retour √† l'accueil apr√®s 5s
                        return;
                    }
                }
            }
            updateUI();
        }

        // Initialisation de l'√©cran √† charger
        showScreen('home-screen');
        // Initialisation de l'UI pour que les badges soient corrects d√®s le chargement si on va direct sur l'√©cran de pri√®re
        updateUI();
    </script>
</body>
</html>
