<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --rosaire-blue: #1e40af;
            --bg-light: #f8fafc;
            --card-light: #ffffff;
        }
        @media (prefers-color-scheme: dark) {
            :root { --bg-light: #0f172a; --card-light: #1e293b; }
            body { color: #f1f5f9; }
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-light);
            margin: 0; padding: 20px; text-align: center;
        }
        .prayer-card {
            background: var(--card-light);
            border-radius: 32px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            max-width: 500px; margin: auto;
            min-height: 520px;
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .mystery-badge {
            background: #eff6ff;
            color: #1e40af;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
            margin-bottom: 10px;
        }
        @media (prefers-color-scheme: dark) {
            .mystery-badge { background: #1e3a8a; color: #dbeafe; }
        }
        .fruit-box {
            font-size: 0.8rem;
            color: #64748b;
            font-style: italic;
            margin-top: 5px;
            display: block;
        }
        .bead-btn {
            width: 60px; height: 60px; border-radius: 50%;
            background: var(--card-light);
            border: 1px solid #e2e8f0;
            display: flex; align-items: center; justify-content: center;
            margin: 10px auto; cursor: pointer; transition: all 0.2s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }
        .bead-btn:active { transform: scale(0.9); }
        .progress-dot { width: 6px; height: 6px; border-radius: 50%; background: #e2e8f0; transition: all 0.3s; }
        .progress-dot.active { background: var(--rosaire-blue); transform: scale(1.4); }
        .text-fade { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="prayer-card mt-8">
        <div>
            <div id="mystery-type" class="mystery-badge">Chargement...</div>
            
            <h2 id="step-title" class="text-[10px] font-900 uppercase tracking-[0.3em] text-blue-800 dark:text-blue-400">DÃ©but</h2>
            
            <div class="my-6 min-h-[220px] flex flex-col items-center justify-center px-2">
                <p id="prayer-content" class="text-base italic font-serif leading-relaxed text-slate-700 dark:text-slate-200 text-fade">
                    Au nom du PÃ¨re...
                </p>
                <span id="mystery-fruit" class="fruit-box hidden"></span>
            </div>
        </div>

        <div>
            <div id="progress-container" class="flex justify-center gap-1.5 mb-4 hidden"></div>
            <p id="counter-text" class="text-[9px] font-black text-slate-400 dark:text-slate-500 uppercase tracking-widest mb-2"></p>
            
            <button id="next-btn" onclick="nextStep()" class="bead-btn">
                <span id="bead-icon" class="text-2xl">ðŸ“¿</span>
            </button>
            
            <p id="instruction" class="text-[9px] font-bold text-slate-300 uppercase mt-4">Touchez le grain pour avancer</p>
        </div>
    </div>

    <script>
        // --- TEXTES DES PRIÃˆRES ---
        const PRAYERS = {
            credo: "Je crois en Dieu, le PÃ¨re tout-puissant, CrÃ©ateur du ciel et de la terre. Et en JÃ©sus-Christ, son Fils unique, notre Seigneur ; qui a Ã©tÃ© conÃ§u du Saint-Esprit, est nÃ© de la Vierge Marie, a souffert sous Ponce Pilate, a Ã©tÃ© crucifiÃ©, est mort et a Ã©tÃ© enseveli, est descendu aux enfers ; le troisiÃ¨me jour est ressuscitÃ© des morts, est montÃ© aux cieux, est assis Ã  la droite de Dieu le PÃ¨re tout-puissant, dâ€™oÃ¹ il viendra juger les vivants et les morts. Je crois en l'Esprit-Saint, Ã  la sainte Eglise catholique, Ã  la communion des saints, Ã  la rÃ©surrection de la chair, Ã  la vie Ã©ternelle. Amen.",
            pater: "Notre PÃ¨re, qui Ãªtes aux cieux, que votre nom soit sanctifiÃ©, que votre rÃ¨gne vienne, que votre volontÃ© soit faite sur la terre comme au ciel. Donnez-nous aujourdâ€™hui notre pain de ce jour. Pardonnez-nous nos offenses, comme nous pardonnons aussi Ã  ceux qui nous ont offensÃ©s. Et ne nous laissez pas succomber Ã  la tentation, mais dÃ©livrez-nous du mal. Amen.",
            ave: "Je vous salue, Marie, pleine de grÃ¢ce ; le Seigneur est avec vous. Vous Ãªtes bÃ©nie entre toutes les femmes et JÃ©sus, le fruit de vos entrailles, est bÃ©ni. Sainte Marie, MÃ¨re de Dieu, priez pour nous pauvres pÃ©cheurs, maintenant et Ã  lâ€™heure de notre mort. Amen.",
            gloria: "Gloire au PÃ¨re, et au Fils, et au Saint-Esprit. Comme il Ã©tait au commencement, maintenant et toujours, et dans les siÃ¨cles des siÃ¨cles. Amen.",
            fatima: "Ã” mon JÃ©sus, pardonnez-nous nos pÃ©chÃ©s, prÃ©servez-nous du feu de l'enfer, et conduisez au Ciel toutes les Ã¢mes, surtout celles qui ont le plus besoin de Votre MisÃ©ricorde."
        };

        // --- MYSTÃˆRES ---
        const MYSTERIES = {
            joyeux: [
                { t: "L'Annonciation", f: "L'humilitÃ©" },
                { t: "La Visitation", f: "La charitÃ© fraternelle" },
                { t: "La NativitÃ©", f: "L'esprit de pauvretÃ©" },
                { t: "La PrÃ©sentation", f: "L'obÃ©issance et la puretÃ©" },
                { t: "Le Recouvrement", f: "La recherche de Dieu" }
            ],
            lumineux: [
                { t: "Le BaptÃªme de JÃ©sus", f: "L'Ã©tat de grÃ¢ce" },
                { t: "Les Noces de Cana", f: "La confiance en Marie" },
                { t: "L'Annonce du Royaume", f: "La conversion" },
                { t: "La Transfiguration", f: "La priÃ¨re" },
                { t: "L'Institution de l'Eucharistie", f: "La ferveur" }
            ],
            douloureux: [
                { t: "L'Agonie", f: "La contrition" },
                { t: "La Flagellation", f: "La mortification des sens" },
                { t: "Le Couronnement d'Ã©pines", f: "La mortification de l'esprit" },
                { t: "Le Portement de Croix", f: "La patience" },
                { t: "La Crucifixion", f: "L'amour de Dieu et des Ã¢mes" }
            ],
            glorieux: [
                { t: "La RÃ©surrection", f: "La foi" },
                { t: "L'Ascension", f: "L'espÃ©rance" },
                { t: "La PentecÃ´te", f: "Le zÃ¨le" },
                { t: "L'Assomption", f: "La dÃ©votion Ã  Marie" },
                { t: "Le Couronnement de Marie", f: "La persÃ©vÃ©rance finale" }
            ]
        };

        // --- LOGIQUE DE DÃ‰TECTION ---
        let day = new Date().getDay(); // 0=Dim, 1=Lun...
        let currentMysteries = [];
        let typeLabel = "";

        if (day === 1 || day === 6) { currentMysteries = MYSTERIES.joyeux; typeLabel = "MystÃ¨res Joyeux"; }
        else if (day === 2 || day === 5) { currentMysteries = MYSTERIES.douloureux; typeLabel = "MystÃ¨res Douloureux"; }
        else if (day === 4) { currentMysteries = MYSTERIES.lumineux; typeLabel = "MystÃ¨res Lumineux"; }
        else { currentMysteries = MYSTERIES.glorieux; typeLabel = "MystÃ¨res Glorieux"; }

        document.getElementById('mystery-type').innerText = typeLabel;

        // --- Ã‰TATS ---
        let step = 0; // 0:Signe, 1:Credo, 2:Pater, 3:3xAve, 4:Gloria
        let decade = 0; // 0 Ã  4
        let bead = -1; // -1:Pater de la dizaine, 0-9: Ave, 10:Gloria/Fatima
        let isStarted = false;

        function updateUI() {
            const content = document.getElementById('prayer-content');
            const fruit = document.getElementById('mystery-fruit');
            const title = document.getElementById('step-title');
            const progress = document.getElementById('progress-container');
            const counter = document.getElementById('counter-text');
            const icon = document.getElementById('bead-icon');

            fruit.classList.add('hidden');
            progress.classList.add('hidden');
            counter.innerText = "";

            if (!isStarted) {
                title.innerText = "Ouverture";
                if(step === 0) content.innerText = "Au nom du PÃ¨re, et du Fils, et du Saint-Esprit. Amen.";
                if(step === 1) content.innerText = PRAYERS.credo;
                if(step === 2) content.innerText = PRAYERS.pater;
                if(step === 3) content.innerText = PRAYERS.ave + " (3 fois pour la Foi, l'EspÃ©rance et la CharitÃ©)";
                if(step === 4) content.innerText = PRAYERS.gloria;
                icon.innerText = "ðŸ“¿";
            } else {
                let m = currentMysteries[decade];
                title.innerText = m.t;
                fruit.innerText = "Fruit : " + m.f;
                fruit.classList.remove('hidden');

                if (bead === -1) {
                    content.innerText = PRAYERS.pater;
                    icon.innerText = "âšª";
                } else if (bead >= 0 && bead <= 9) {
                    content.innerText = PRAYERS.ave;
                    progress.classList.remove('hidden');
                    counter.innerText = `Dizaine ${decade+1} â€¢ Grain ${bead+1}/10`;
                    icon.innerText = "ðŸ”¹";
                    renderDots();
                } else {
                    content.innerText = PRAYERS.gloria + "\n\n---\n\n" + PRAYERS.fatima;
                    icon.innerText = "âœ¨";
                }
            }
        }

        function renderDots() {
            const container = document.getElementById('progress-container');
            container.innerHTML = "";
            for (let i = 0; i < 10; i++) {
                const dot = document.createElement('div');
                dot.className = `progress-dot ${i <= bead ? 'active' : ''}`;
                container.appendChild(dot);
            }
        }

        function nextStep() {
            if (!isStarted) {
                if (step < 4) step++;
                else isStarted = true;
            } else {
                if (bead < 10) {
                    bead++;
                } else {
                    if (decade < 4) {
                        decade++;
                        bead = -1;
                    } else {
                        // FIN DU ROSAIRE
                        document.getElementById('prayer-content').innerText = "Salve Regina...\nAu nom du PÃ¨re, et du Fils, et du Saint-Esprit. Amen.";
                        document.getElementById('instruction').innerText = "Rosaire terminÃ©. Retour auto...";
                        setTimeout(() => window.parent.location.href = 'priere.html', 4000);
                        return;
                    }
                }
            }
            updateUI();
        }

        updateUI();
    </script>
</body>
</html>
