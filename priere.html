<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mur de PriÃ¨res - La Croix Glorieuse</title>
    <link rel="stylesheet" href="CSS/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-slate-50 pb-24">

    <header class="gradient-header text-white p-8 rounded-b-[40px] shadow-2xl">
        <div class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-xl font-800 tracking-tight">Le Mur de PriÃ¨res</h1>
                <p class="text-[9px] font-black uppercase tracking-widest opacity-80">Communion des Saints â€¢ Strasbourg</p>
            </div>
            <div class="px-3 py-1 bg-black/20 rounded-full text-[9px] font-black uppercase italic italic">Intentions</div>
        </div>
        <div class="bg-white/10 backdrop-blur-md p-6 rounded-3xl border border-white/20">
            <p class="text-sm font-medium italic italic">"Demandez, et l'on vous donnera."</p>
        </div>
    </header>

    <main class="p-6 space-y-8">
        <section class="card border-l-4 border-red-700">
            <h2 class="text-[9px] font-black text-red-700 uppercase mb-4 tracking-widest">Confier une intention</h2>
            <textarea id="intent-txt" class="w-full p-4 bg-slate-50 rounded-2xl border-none text-sm outline-none" placeholder="Votre intention..." rows="3"></textarea>
            <button onclick="sendIntention()" class="w-full bg-red-700 text-white py-4 rounded-2xl font-800 text-[10px] uppercase tracking-widest mt-4 shadow-lg active:scale-95 transition-all">
                Envoyer au Mur
            </button>
        </section>

        <section class="space-y-4">
            <h2 class="text-lg font-800 text-slate-900 tracking-tight px-2">DerniÃ¨res Intentions</h2>
            <div id="mur-intentions" class="space-y-4"></div>
        </section>
    </main>

    <nav class="bottom-nav">
        <a href="index.html" class="nav-item"><span>ğŸ </span>Accueil</a>
        <a href="agenda.html" class="nav-item"><span>ğŸ“…</span>Agenda</a>
        <a href="priere.html" class="nav-item active"><span>ğŸ•¯ï¸</span>PriÃ¨res</a>
        <a href="groupes.html" class="nav-item"><span>ğŸ’¬</span>Groupes</a>
    </nav>

    <script src="js/config.js"></script>
    <script>
        async function loadIntentions() {
            const { data } = await sb.from('intentions').select('*').order('created_at', { ascending: false });
            if (data) {
                document.getElementById('mur-intentions').innerHTML = data.map(i => `
                    <div class="card animate-fade-in border border-slate-50">
                        <p class="text-sm text-slate-700 leading-relaxed font-medium">"${i.texte}"</p>
                        <p class="text-[9px] font-black text-slate-300 uppercase tracking-widest mt-4">${new Date(i.created_at).toLocaleDateString()}</p>
                    </div>
                `).join('');
            }
        }

        async function sendIntention() {
            const txt = document.getElementById('intent-txt').value;
            if(!txt) return;
            const { error } = await sb.from('intentions').insert([{ texte: txt }]);
            if(!error) { document.getElementById('intent-txt').value = ''; loadIntentions(); }
        }
        loadIntentions();
    </script>
</body>
</html>
