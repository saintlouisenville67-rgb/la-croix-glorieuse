<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --misericorde-red: #b91c1c;
            --bg-light: #f8fafc;
            --card-light: #ffffff;
        }
        @media (prefers-color-scheme: dark) {
            :root { --bg-light: #0f172a; --card-light: #1e293b; }
            body { color: #f1f5f9; }
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-light);
            margin: 0; padding: 20px; text-align: center;
        }
        .prayer-card {
            background: var(--card-light);
            border-radius: 32px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            max-width: 500px; margin: auto;
            min-height: 480px;
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .jesus-img {
            width: 100px; height: 100px; border-radius: 50%;
            margin: -50px auto 10px; border: 4px solid white;
            box-shadow: 0 8px 20px rgba(185, 28, 28, 0.2);
            object-fit: cover; background: white;
        }
        .faustine-quote {
            background: #fef2f2;
            border-radius: 20px;
            padding: 12px 18px;
            font-size: 0.85rem;
            color: #991b1b;
            margin-bottom: 15px;
            border: 1px dashed #fecaca;
            animation: fadeIn 0.5s ease-out;
        }
        @media (prefers-color-scheme: dark) {
            .faustine-quote { background: #450a0a; color: #fecaca; border-color: #7f1d1d; }
        }
        .bead-btn {
            width: 60px; height: 60px; border-radius: 50%;
            background: var(--card-light);
            border: 1px solid #e2e8f0;
            display: flex; align-items: center; justify-content: center;
            margin: 10px auto; cursor: pointer; transition: all 0.2s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }
        .bead-btn:active { transform: scale(0.9); }
        .progress-dot { width: 7px; height: 7px; border-radius: 50%; background: #e2e8f0; transition: all 0.3s; }
        .progress-dot.active { background: var(--misericorde-red); transform: scale(1.4); }
        .text-fade { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="prayer-card mt-16">
        <div>
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a8/Divine_Mercy.jpg/480px-Divine_Mercy.jpg" class="jesus-img" alt="JÃ©sus MisÃ©ricordieux">
            
            <div id="quote-box" class="faustine-quote hidden italic"></div>

            <h2 id="step-title" class="text-[10px] font-900 uppercase tracking-[0.3em] text-red-700">DÃ©but</h2>
            
            <div class="my-6 min-h-[140px] flex items-center justify-center px-2">
                <p id="prayer-content" class="text-lg italic font-serif leading-relaxed text-slate-700 dark:text-slate-200 text-fade">
                    Au nom du PÃ¨re, et du Fils, et du Saint-Esprit. Amen.
                </p>
            </div>
        </div>

        <div>
            <div id="progress-container" class="flex justify-center gap-2.5 mb-4 hidden"></div>
            <p id="counter-text" class="text-[9px] font-black text-slate-400 dark:text-slate-500 uppercase tracking-widest mb-2"></p>
            <button id="next-btn" onclick="nextStep()" class="bead-btn">
                <span id="bead-icon" class="text-2xl">ðŸ“¿</span>
            </button>
            <p id="instruction" class="text-[9px] font-bold text-slate-300 uppercase mt-4 tracking-tighter">Touchez le grain pour avancer</p>
        </div>
    </div>

    <script>
        let currentStep = 0;
        let currentBead = 0;
        let currentDecade = 1;

        const faustineQuotes = [
            "Â« Plus la misÃ¨re est grande, plus elle a droit Ã  Ma misÃ©ricorde. Â» (PJ 1182)",
            "Â« Je ne peux punir mÃªme le plus grand pÃ©cheur s'il invoque Ma pitiÃ©. Â» (PJ 1146)",
            "Â« Dis Ã  l'Ã¢me souffrante qu'elle se serre contre Mon CÅ“ur misÃ©ricordieux. Â» (PJ 1486)",
            "Â« Ma MisÃ©ricorde est plus grande que tes pÃ©chÃ©s et ceux du monde entier. Â» (PJ 1485)",
            "Â« L'humanitÃ© n'aura pas de paix tant qu'elle ne s'adressera pas Ã  Ma MisÃ©ricorde. Â» (PJ 300)"
        ];

        const steps = [
            { title: "DÃ©but", text: "Au nom du PÃ¨re, et du Fils, et du Saint-Esprit. Amen." },
            { title: "Introduction", text: "Notre PÃ¨re... Je vous salue Marie... Je crois en Dieu..." },
            { title: "Gros Grain", text: "PÃ¨re Ã‰ternel, je Vous offre le Corps et le Sang, l'Ã‚me et la DivinitÃ© de Votre Fils Bien-AimÃ©, Notre Seigneur JÃ©sus-Christ, en rÃ©paration de nos pÃ©chÃ©s et de ceux du monde entier." },
            { title: "Dizaine", text: "Par Sa douloureuse Passion, ayez pitiÃ© de nous et du monde entier." },
            { title: "Conclusion (3 fois)", text: "Dieu Saint, Dieu Fort, Dieu Ã‰ternel, ayez pitiÃ© de nous et du monde entier." },
            { title: "Fin", text: "JÃ©sus MisÃ©ricorideux, j'ai confiance en Vous !" }
        ];

        function updateUI() {
            const step = steps[currentStep];
            const contentEl = document.getElementById('prayer-content');
            const quoteBox = document.getElementById('quote-box');
            
            contentEl.innerText = step.text;
            document.getElementById('step-title').innerText = step.title;

            // Afficher citation Faustine seulement sur le Gros Grain de chaque dizaine
            if (currentStep === 2) {
                quoteBox.innerText = faustineQuotes[currentDecade - 1];
                quoteBox.classList.remove('hidden');
            } else {
                quoteBox.classList.add('hidden');
            }

            const progress = document.getElementById('progress-container');
            const counter = document.getElementById('counter-text');
            const icon = document.getElementById('bead-icon');

            if (currentStep === 3) {
                progress.classList.remove('hidden');
                counter.innerText = `Dizaine ${currentDecade} â€¢ Grain ${currentBead + 1}/10`;
                icon.innerText = "ðŸ”¸";
                renderDots();
            } else {
                progress.classList.add('hidden');
                counter.innerText = "";
                icon.innerText = (currentStep === 2) ? "âšª" : (currentStep === 5 ? "âœ¨" : "ðŸ“¿");
            }

            // FERMETURE AUTOMATIQUE Ã€ LA FIN
            if (currentStep === 5) {
                document.getElementById('instruction').innerText = "Fin de la priÃ¨re. Retour auto...";
                setTimeout(() => {
                    // On ferme l'iframe en changeant l'URL de la page parente
                    window.parent.location.href = 'priere.html';
                }, 3500);
            }
        }

        function renderDots() {
            const container = document.getElementById('progress-container');
            container.innerHTML = "";
            for (let i = 0; i < 10; i++) {
                const dot = document.createElement('div');
                dot.className = `progress-dot ${i <= currentBead ? 'active' : ''}`;
                container.appendChild(dot);
            }
        }

        function nextStep() {
            if (currentStep === 5) return; // Bloquer si c'est fini

            if (currentStep === 3) {
                if (currentBead < 9) {
                    currentBead++;
                } else {
                    currentBead = 0;
                    if (currentDecade < 5) {
                        currentDecade++;
                        currentStep = 2;
                    } else {
                        currentStep = 4;
                    }
                }
            } else {
                currentStep++;
            }
            updateUI();
        }

        updateUI();
    </script>
</body>
</html>
