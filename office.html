<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Breviarium</title>
    <style>
        body, html {
            margin: 0; padding: 0; height: 100%; width: 100%;
            overflow: hidden; background-color: #000;
        }

        /* Animation d'entrée type "App" */
        .app-wrapper {
            opacity: 0;
            transform: scale(0.98) translateY(10px);
            animation: launchApp 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
            height: 100vh; width: 100vw; background: #fff;
        }

        @keyframes launchApp {
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        iframe { border: none; width: 100%; height: 100%; display: block; }

        /* Bouton flottant déplaçable */
        #draggable-button {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 99999;
            
            width: 44px;
            height: 44px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            color: #333;
            cursor: move; /* Indique qu'on peut le déplacer */
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            touch-action: none; /* Empêche le scroll pendant le drag sur mobile */
            user-select: none;
        }

        .close-icon {
            font-family: sans-serif;
            font-size: 26px;
            font-weight: 200;
            pointer-events: none; /* L'icône ne gêne pas le clic sur le bouton */
        }

        #draggable-button:hover {
            color: #d4af37;
            background: #fff;
        }
    </style>
</head>
<body>

    <div class="app-wrapper">
        <a href="index.html" id="draggable-button" title="Retour à l'accueil">
            <span class="close-icon">&times;</span>
        </a>

        <iframe src="https://breviariumgregorianum.com/" allowfullscreen></iframe>
    </div>

    <script>
        const dragItem = document.querySelector("#draggable-button");
        let active = false;
        let currentX;
        let currentY;
        let initialX;
        let initialY;
        let xOffset = 0;
        let yOffset = 0;

        // Événements Tactiles (Mobile)
        window.addEventListener("touchstart", dragStart, false);
        window.addEventListener("touchend", dragEnd, false);
        window.addEventListener("touchmove", drag, false);

        // Événements Souris
        window.addEventListener("mousedown", dragStart, false);
        window.addEventListener("mouseup", dragEnd, false);
        window.addEventListener("mousemove", drag, false);

        function dragStart(e) {
            if (e.target === dragItem) {
                if (e.type === "touchstart") {
                    initialX = e.touches[0].clientX - xOffset;
                    initialY = e.touches[0].clientY - yOffset;
                } else {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;
                }
                active = true;
            }
        }

        function dragEnd(e) {
            initialX = currentX;
            initialY = currentY;
            active = false;
        }

        function drag(e) {
            if (active) {
                e.preventDefault();
                if (e.type === "touchmove") {
                    currentX = e.touches[0].clientX - initialX;
                    currentY = e.touches[0].clientY - initialY;
                } else {
                    currentX = e.clientX - initialX;
                    currentY = e.clientY - initialY;
                }
                xOffset = currentX;
                yOffset = currentY;
                setTranslate(currentX, currentY, dragItem);
            }
        }

        function setTranslate(xPos, yPos, el) {
            el.style.transform = "translate3d(" + xPos + "px, " + yPos + "px, 0)";
        }
    </script>

</body>
</html>
